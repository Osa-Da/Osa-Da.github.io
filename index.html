<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0 maximum-scale=1.0, user-scalable=no"
        />
        <title>РАССКАЖИ О СЕБЕ!</title>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                touch-action: manipulation;
            }

            body {
                background-color: #121212;
                color: #e0e0e0;
                line-height: 1.6;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px;
                transition: background-color 0.3s;
            }

            .container {
                width: 100%;
                max-width: 600px;
                margin: 0 auto;
                position: relative;
            }

            .screen {
                background-color: #1e1e1e;
                border-radius: 20px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                padding: 30px;
                text-align: center;
                transition: transform 0.5s, opacity 0.5s;
                display: none;
                width: 100%;
            }

            .screen.active {
                display: block;
                animation: fadeIn 0.5s forwards;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* Начальный экран */
            .start-screen {
                padding: 40px 30px;
            }

            .start-screen h1 {
                color: #4caf50;
                margin-bottom: 20px;
                font-size: 28px;
            }

            .start-screen p {
                color: #aaa;
                margin-bottom: 40px;
                font-size: 16px;
            }

            .btn {
                background-color: #4caf50;
                color: white;
                border: none;
                padding: 16px 40px;
                font-size: 18px;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s;
                font-weight: 600;
                box-shadow: 0 4px 15px rgba(163, 163, 163, 0.3);
                display: inline-block;
                margin: 5px;
            }

            .red {
                background-color: brown;
                box-shadow: 0 4px 15px rgba(175, 76, 76, 0.3);
            }

            .btn:hover {
                background-color: #3d8b40;
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(167, 167, 167, 0.4);
            }

            .btn:active {
                transform: translateY(0);
            }

            .btn-small {
                padding: 12px 25px;
                font-size: 16px;
            }

            .btn-more {
                background-color: #ffc107;
                box-shadow: 0 4px 15px rgba(175, 173, 76, 0.3);
                color: #333;
            }

            .btn-more:hover {
                background-color: #ffb300;
            }

            .btn-list {
                background-color: #2196f3;
            }

            .btn-list:hover {
                background-color: #0b7dda;
            }

            .btn-group {
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-top: 20px;
            }

            /* Окна подтверждения */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.85);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                padding: 20px;
                display: none;
            }

            .modal-overlay.active {
                display: flex;
                animation: fadeIn 0.3s forwards;
            }

            .modal {
                background-color: #2d2d2d;
                border-radius: 20px;
                padding: 30px;
                max-width: 500px;
                width: 100%;
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
                text-align: center;
            }

            .modal h2 {
                color: #4caf50;
                margin-bottom: 15px;
                font-size: 24px;
            }

            .modal p {
                color: #aaa;
                margin-bottom: 25px;
                font-size: 16px;
            }

            .note {
                background-color: #2a3d2a;
                border-left: 4px solid #4caf50;
                padding: 12px 15px;
                margin: 20px 0;
                text-align: left;
                font-size: 15px;
                border-radius: 0 8px 8px 0;
                color: #c8e6c9;
            }

            /* Экран вопросов */
            .questions-screen {
                position: relative;
                min-height: 400px;
                display: none;
                flex-direction: column;
            }

            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .counter {
                font-size: 18px;
                font-weight: 600;
                color: #4caf50;
                background-color: #2a3d2a;
                padding: 8px 15px;
                border-radius: 50px;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .timer {
                font-size: 18px;
                font-weight: 600;
                color: #ffc107;
                background-color: #3d3a2a;
                padding: 8px 15px;
                border-radius: 50px;
                display: flex;
                align-items: center;
                gap: 8px;
                transition: all 0.3s;
            }

            .timer.expired {
                background-color: #ffffff;
                color: #333;
                animation: pulseTimer 1s infinite;
            }

            @keyframes pulseTimer {
                0% {
                    box-shadow: 0 0 5px #ffffff;
                }
                50% {
                    box-shadow: 0 0 15px #ffffff;
                }
                100% {
                    box-shadow: 0 0 5px #ffffff;
                }
            }

            .timer i {
                font-size: 16px;
            }

            .question-category {
                color: #ffc107;
                font-size: 20px;
                margin-bottom: 10px;
                text-align: center;
                font-weight: 600;
                position: fixed;
                left: 5px;
                top: 0;
            }

            .question-container {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                padding: 20px 0;
            }

            .question-text {
                font-size: 22px;
                font-weight: 600;
                color: #ffffff;
                margin-bottom: 40px;
                line-height: 1.5;
                text-align: center;
                min-height: 100px;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 0 10px;
                width: 100%;
                overflow-wrap: anywhere;
            }

            .navigation {
                display: flex;
                justify-content: space-between;
                width: 100%;
                margin-top: 20px;
                position: relative;
            }

            .nav-btn {
                background-color: #4caf50;
                color: white;
                border: none;
                width: 80px;
                height: 80px;
                border-radius: 50%;
                cursor: pointer;
                transition: all 0.3s;
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 28px;
            }

            .nav-btn:hover {
                background-color: #3d8b40;
                transform: translateY(-2px);
                box-shadow: 0 6px 15px rgba(76, 175, 80, 0.4);
            }

            .nav-btn:disabled {
                background-color: #444;
                cursor: not-allowed;
                transform: none;
                box-shadow: none;
            }

            .nav-btn.list-btn {
                background-color: #2196f3;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                width: 60px;
                height: 60px;
                font-size: 22px;
            }

            .nav-btn.list-btn:hover {
                background-color: #0b7dda;
            }

            .nav-btn.submit-btn {
                background-color: #ffc107;
                color: #333;
            }

            .nav-btn.submit-btn:hover {
                background-color: #ffb300;
            }

            /* Экран завершения */
            .finish-screen {
                padding: 40px 30px;
            }

            .finish-screen h1 {
                color: #ffc107;
                margin-bottom: 20px;
                font-size: 32px;
                text-shadow: 0 2px 10px rgba(255, 193, 7, 0.3);
            }

            .finish-screen p {
                color: #aaa;
                margin-bottom: 30px;
                font-size: 18px;
            }

            .stars {
                font-size: 50px;
                margin-bottom: 25px;
                color: #ffc107;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.1);
                }
                100% {
                    transform: scale(1);
                }
            }

            .three-stars {
                color: #ffd700;
                text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            }

            .three-stars i {
                margin: 0 10px;
            }

            /* Список вопросов */
            .questions-list-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 2000;
                padding: 20px;
                display: none;
            }

            .questions-list-modal.active {
                display: flex;
                animation: fadeIn 0.3s forwards;
            }

            .questions-list-container {
                background-color: #2d2d2d;
                border-radius: 20px;
                padding: 30px;
                max-width: 500px;
                width: 100%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            }

            .questions-list-container h2 {
                color: #4caf50;
                margin-bottom: 20px;
                text-align: center;
                font-size: 24px;
            }

            .questions-list {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }

            .hidden {
                display: none;
            }

            .question-item {
                background-color: #3a3a3a;
                border-radius: 10px;
                padding: 12px 15px;
                cursor: pointer;
                transition: all 0.3s;
                display: flex;
                align-items: center;
                gap: 10px;
                border-left: 4px solid transparent;
            }

            .question-item:hover {
                background-color: #4a4a4a;
                transform: translateX(5px);
            }

            .question-item.current {
                border-left-color: #ffc107;
                background-color: #3d3a2a;
            }

            .question-item.answered .question-status {
                color: #4caf50;
            }

            .question-item.unanswered .question-status {
                color: #888;
            }

            .question-number {
                font-weight: bold;
                color: #ffc107;
                min-width: 25px;
            }

            .question-text-short {
                flex: 1;
                text-align: left;
                font-size: 14px;
                line-height: 1.4;
                overflow-wrap: anywhere;
            }

            .question-status {
                font-size: 16px;
            }

            .close-list-btn {
                margin-top: 20px;
                width: 100%;
            }

            .stage-title {
                color: #2196f3;
                margin: 15px 0 10px;
                font-size: 18px;
                text-align: left;
                font-weight: 600;
                border-bottom: 2px solid #2196f3;
                padding-bottom: 5px;
            }

            /* Адаптивность для мобильных */
            @media (max-width: 600px) {
                body {
                    padding: 10px;
                }

                .screen {
                    padding: 25px 20px;
                    border-radius: 15px;
                }

                .start-screen h1 {
                    font-size: 24px;
                }

                .question-text {
                    font-size: 20px;
                    min-height: 80px;
                }

                .modal {
                    padding: 25px 20px;
                }

                .modal h2 {
                    font-size: 22px;
                }

                .btn-group {
                    flex-direction: column;
                    gap: 10px;
                }

                .btn {
                    width: 100%;
                    padding: 14px 20px;
                }

                .header {
                    flex-direction: column;
                    gap: 15px;
                    margin-bottom: 20px;
                }

                .counter,
                .timer {
                    width: 100%;
                    justify-content: center;
                }

                .nav-btn {
                    width: 70px;
                    height: 70px;
                    font-size: 24px;
                }

                .nav-btn.list-btn {
                    width: 55px;
                    height: 55px;
                    font-size: 20px;
                }

                .stars {
                    font-size: 40px;
                }

                .questions-list-container {
                    padding: 20px;
                }
            }

            .start-screen h1 {
                font-size: 22px;
            }

            .question-text {
                font-size: 18px;
            }

            .nav-btn {
                width: 65px;
                height: 65px;
                font-size: 22px;
            }

            .nav-btn.list-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }

            .finish-screen h1 {
                font-size: 26px;
            }

            .password-screen {
            }

            .password-input {
                background: none;
                box-shadow: none;
                border: none;
                padding: 10px;
                font-size: 25px;
                text-align: center;
                color: white;
                width: 100%;
                min-height: 50px;
            }

            .password-input-container {
            }

            .btn-auth {
                margin-top: 20px;
            }

            .stars {
                font-size: 35px;
            }

            #timerWrapper {
                width: 100%;
            }
        </style>
    </head>
    <body>
        <!-- Экран ввода пароля -->
        <div class="screen password-screen" id="passwordScreen">
            <div class="password-input-container">
                <input
                    type="text"
                    class="password-input"
                    id="passwordInput"
                    placeholder="Как вас зовут ?"
                />
                <button class="btn btn-auth" id="loginBtn">Войти</button>
                <button
                    class="btn btn-auth"
                    id="logoutBtn"
                    style="display: none; margin-top: 10px; background-color: #666"
                >
                    Выйти
                </button>
            </div>
            <div id="passwordError" style="color: red; margin-top: 10px; display: none">
                Неверный пароль!
            </div>
        </div>

        <!-- Экран приветствия -->
        <div class="screen welcome-screen" id="welcomeScreen">
            <h1 id="welcomeTitle"></h1>
            <div style="margin-bottom: 20px; color: #888; font-size: 14px">
                <i class="fas fa-info-circle"></i> Ваш прогресс автоматически сохраняется
            </div>
            <button class="btn btn-auth" id="startQuizBtn">Ага</button>
            <button class="btn red" id="resetProgressBtn" style="margin-top: 10px">
                <i class="fas fa-trash-alt"></i> Выйти
            </button>
        </div>

        <!-- Остальная часть кода -->
        <div>
            <div class="question-category" id="questionCategory">Вопросы от других участников</div>

            <div class="container">
                <!-- Начальный экран викторины -->
                <div class="screen start-screen" id="startScreen">
                    <h1>СУТЬ</h1>
                    <p>
                        Просто кайфуйте, отвечая на вопросы, пока снимаете свою рубрику, наматывая
                        минимальные 10 минут
                    </p>
                    <button class="btn" id="startBtn">Ага</button>
                </div>

                <!-- Экран вопросов -->
                <div class="screen questions-screen" id="questionsScreen">
                    <div class="header">
                        <div class="counter" id="counter">
                            <i class="fas fa-list-ol"></i> <span id="counterText">1/10</span>
                        </div>
                        <!-- Обертка для таймера -->
                        <div id="timerWrapper">
                            <div class="timer" id="timer">
                                <i class="fas fa-clock"></i> <span id="timerDisplay">10:00</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-container">
                        <div class="question-text" id="questionText">
                            <!-- Вопрос будет загружен динамически -->
                        </div>

                        <div class="navigation">
                            <button class="nav-btn" id="prevBtn" disabled>
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <button class="nav-btn list-btn" id="listBtn">
                                <i class="fas fa-list"></i>
                            </button>
                            <button class="nav-btn" id="nextBtn">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Экран завершения (первый этап) -->
                <div class="screen finish-screen" id="finishScreen">
                    <div class="stars" id="stars">
                        <i class="fas fa-star"></i>
                    </div>
                    <h1>ПИЗДЕЦ ТЫ МОЛОДЕЦ, ПРЯМ АХУЕННА, СПАСИБО</h1>
                    <p>Вы успешно ответили на все вопросы от других участников!</p>
                    <div class="btn-group">
                        <button class="btn btn-more" id="moreQuestionsBtn">БОЛЬШЕ ВОПРОСОВ</button>
                        <button class="btn btn-list" id="finishListBtn">Список вопросов</button>
                        <button class="btn" id="restartBtn">Начать заново</button>
                    </div>
                </div>

                <!-- Экран завершения (все 100 вопросов) -->
                <div class="screen finish-screen" id="finalScreen">
                    <div class="stars three-stars">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i
                        ><i class="fas fa-star"></i>
                    </div>
                    <h1>БОЖЕСТВЕННЫЙ УРОВЕНЬ!</h1>
                    <p>
                        Вы прошли все 100 вопросов! Это невероятное достижение. Вы не просто
                        ответили на вопросы - вы открыли новые грани своей личности, задумались над
                        важными темами и, возможно, узнали о себе что-то новое. Вы настоящий философ
                        и исследователь человеческой души! КРАСАВА
                    </p>
                    <div class="btn-group">
                        <button class="btn btn-list" id="finalListBtn">Список вопросов</button>
                        <button class="btn" id="finalRestartBtn">Начать заново</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальные окна -->
        <div class="modal-overlay" id="confirmationModal1">
            <div class="modal">
                <h2>ВЫ УВЕРЕНЫ ЧТО ГОТОВЫ ОТВЕЧАТЬ НА ВОПРОСЫ?</h2>
                <p>Обратного пути не будет, тут что-то типо сохранения прогресса</p>
                <div class="btn-group">
                    <button class="btn" id="confirmYes1">Да, готов</button>
                    <button class="btn red" id="confirmNo1">Нет, не готов</button>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="confirmationModal2">
            <div class="modal">
                <h2>ВЫ УЖЕ СНИМАЕТЕ РУБРИКУ?</h2>
                <p>Мы хотим видеть ваши эмоции, делайте это на видео</p>
                <div class="note">
                    Пожалуйста, убедитесь, что ваша камера включена. Постарайтесь сделать всё одним
                    дублем, самые яркие и красочные эмоции - это первые) Косячьте, запинайтесь,
                    путайтесь - ничего страшного, это весело, помните - вы прекрасны
                </div>
                <div class="btn-group">
                    <button class="btn btn-yes" id="confirmYes2">Да, снимаю</button>
                    <button class="btn btn-no red" id="confirmNo2">Нет, не снимаю</button>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="timeoutModal">
            <div class="modal">
                <h2>ВЫ ВЫПОЛНИЛИ МИНИМАЛЬНУЮ ДЛИТЕЛЬНОСТЬ, СПАСИБО</h2>
                <p>Вы ответили на вопросы в установленное время. Поздравляем!</p>
                <button class="btn" id="timeoutOkBtn">Продолжить</button>
            </div>
        </div>

        <!-- Модальное окно списка вопросов -->
        <div class="questions-list-modal" id="questionsListModal">
            <div class="questions-list-container">
                <h2>Список вопросов</h2>
                <div id="questionsList">
                    <!-- Список вопросов будет заполнен динамически -->
                </div>
                <button class="btn close-list-btn" id="closeListBtn">Закрыть</button>
            </div>
        </div>

        <script>
            // Пароли и настройки пользователей
            const USER_CONFIG = {
                Серёжа97: {
                    name: 'Серёжа',
                    mainQuestions: [
                        'Сколько раз отжался за год?',
                        'Что делал 17 сентября в 18:32?',
                        'Где моя футболка которую я проебал в 2013?',
                        'Где собака?',
                        'Зачем бог создал женщину?',
                        'Сколько раз смотрел порнуху?',
                        'Чебуреки будем готовить на праздниках?',
                        'Каким ты хочешь быть, опиши внешность и черты характера?',
                        'Что ты хочешь делать для себя не для кого-то?',
                        'А что значит девка хоть куда?',
                        'Зачем мы выключаем радио в машине, если плохо видна дорога? А если нам там ничего не слышно, зачем мы снимаем солнечные очки?',
                        'Как работает интернет?',
                    ],
                },
                Лиза1111: {
                    name: 'Лиза',
                    mainQuestions: [
                        'Ты всегда выглядешь "заряженной", ты выбираешь быть такой или это твой характер ?',
                        'Расскажи самую странную и смешную поебень, которая с тобой случалась или о которой ты слышала',
                        'Какие у тебя мечты, планы на будущее ?',
                        'Какой подарок ты хочешь на Новый год?',
                        'Какой сериал тебе понравился больше всех в этом году?',
                        'Хотела бы отстрапонить кого то?',
                        'Что будешь делать 1 января?',
                        'Хотела ли бы ты встать на путь ЗОЖ-ника или эта поебень не для тебя ?',
                        'Какой актер или актриса тебе нравятся? Можно не колько',
                        'В какой стране ты бы хотела жить и почему?',
                        'Какое у тебя хобби или чем бы ты хотела заниматься не имея с этого финансовой прибыли?',
                        'Кем ты хотела стать в детстве и почему не стала?',
                    ],
                },
                Аркаша666: {
                    name: 'Аркаша',
                    mainQuestions: [
                        'От какой музыки у тебя ебало рвёт (кайфуешь). Как считаешь - почему ?',
                        'Как считаешь, какие лучшие качества человека и почему ?',
                        'Как бы ты отреагировал на то,что твои друзья признались что они геи?',
                        'Когда мы будем играть в балдуру?',
                        'Каким бы человеком ты хотел стать, опиши характер?',
                        'Что бы ты всем посоветовал сделать, попробовать, то что ты сам делала и почему?',
                        'Твоя любимая поза в процессе раскладке плитки ?',
                        'Представь ты в фильме, какой это фильм и что ты за персонаж?',
                        'Что делать если паребухи присохли на попке,а воды нет?',
                        'Хотел ли бы жить в частном доме или ты квартирный ?',
                        'Как в твоей семье проходило утро?',
                        'Твое самое глухое действие на первом свидании(просто свидании)',
                    ],
                },
                Кристина69: {
                    name: 'Кристина',
                    mainQuestions: [
                        'Назови самый странный факт о себе?',
                        'Хотела ли бы ты стать художником, если да, то каким, какой стиль ?',
                        'Сколько картин нарисовала?',
                        'Какой самы сложный босс в дарк соулс 2?',
                        'Хотела ли бы ты жить подальше от родни - не в Тюменской области, если да то где ?',
                        'Где находится Антарктида?',
                        'Сколько палочек твикс нужно 4 людям?',
                        'Лучшие качества человека по твоему мнению ?',
                        'Как бы ты жила если бы не забывала о том,что ты так-то не планировала напиваться ',
                        'Расскажи смешной момент из садика/школы',
                        'Какие планы на будущее, мечты ?',
                        'Почему не выпускают корм для кошек со вкусом мышей?',
                    ],
                },
                '0000': {
                    name: 'Тест',
                    mainQuestions: [
                        'ТЕКСТ ВОПРОСА 1',
                        'ТЕКСТ ВОПРОСА 2',
                        'ВСЁ, ДАЛЬШЕ НЕ ЧАКАЙ, ПЕРЕЗАГРУЖАЙ',
                        'Я серьёзно, ПЕРЕЗАГРУЖАЙ',
                        'перезагружай...',
                        'перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                        'перезагружай...',
                    ],
                },
            };

            // Все вопросы по категориям (общие для всех)
            const allQuestions = [
                {
                    category: 'Философские/Глубокие вопросы',
                    questions: [
                        'В чем для тебя смысл жизни?',
                        'Что для тебя важнее: счастье или успех?',
                        'Как ты думаешь, существует ли свобода воли или все предопределено?',
                        'Что такое настоящая любовь по-твоему?',
                        'Если бы у тебя был один день, чтобы прожить его заново, какой бы это был день?',
                        'Что страшнее: смерть или бессмысленная жизнь?',
                        'Есть ли что-то, ради чего ты готов умереть?',
                        'Какой самый важный урок ты вынес из жизни?',
                        'Что делает человека по-настоящему счастливым?',
                        'Если бы ты мог изменить одну вещь в мире, что бы это было?',
                    ],
                },
                {
                    category: 'Кринжовые/Неловкие вопросы',
                    questions: [
                        'Опиши свое самое неловкое свидание',
                        'Какую самую глупую вещь ты делал ради любви?',
                        'В какой момент своей жизни ты чувствовал себя самым большим лузером?',
                        'Какая твоя самая постыдная привычка?',
                        'Когда ты последний раз плакал от стыда?',
                        'Какую самую дурацкую покупку ты совершил?',
                        'О чем ты больше всего сожалеешь?',
                        'Какую самую странную ложь ты рассказывал?',
                        "Когда ты в последний раз попадал в ситуацию 'лучше бы я провалился сквозь землю'?",
                        'Какая твоя самая неудачная попытка быть крутым?',
                    ],
                },
                {
                    category: 'Веселые/Интересные вопросы',
                    questions: [
                        'Кто лучше: кошки или собаки и почему?',
                        'Если бы ты был супергероем, какими были бы твои суперспособности и почему?',
                        'Какое твое самое странное убеждение или суеверие?',
                        'Какой самый безумный поступок ты совершил в состоянии алкогольного опьянения?',
                        'Если бы ты мог стать любым животным на неделю, кем бы ты стал и почему?',
                        'Какой самый странный сон ты помнишь?',
                        'Если бы ты мог есть только одну еду всю жизнь, что бы это было?',
                        'Какая самая глупая вещь, в которую ты верил в детстве?',
                        'Если бы тебе дали миллион долларов, но ты должен был бы потратить их за 24 часа, как бы ты это сделал?',
                        'Какой самый странный комплимент ты получал?',
                    ],
                },
                {
                    category: 'О жизни и отношениях',
                    questions: [
                        'Что для тебя важнее в отношениях: страсть или стабильность?',
                        'Можно ли прочить измену?',
                        'Веришь ли ты в дружбу между мужчиной и женщиной?',
                        'Что для тебя сложнее: прочить или забыть?',
                        'Можно ли быть счастливым в одиночестве?',
                        'Что важнее: карьера или семья?',
                        'Считаешь ли ты, что у людей бывает одна настоящая любовь?',
                        'Можно ли построить отношения на расстоянии?',
                        "Что для тебя значат слова 'настоящий друг'?",
                        'В каком возрасте, по-твоему, нужно создавать семью?',
                    ],
                },
                {
                    category: 'Гипотетические ситуации',
                    questions: [
                        'Если бы ты узнал, что через год наступит конец света, как бы ты прожил этот год?',
                        'Если бы у тебя была машина времени, куда и в какое время ты бы отправился?',
                        'Если бы ты мог задать только один вопрос всемогущему существу, что бы ты спросил?',
                        'Если бы ты стал невидимым на день, что бы ты сделал?',
                        'Если бы ты мог прожить жизнь другого человека на неделю, кем бы ты стал?',
                        'Если бы все твои желания исполнялись, но только на 24 часа, что бы ты загадал?',
                        'Если бы ты мог стереть из памяти один фильм/сериал, чтобы посмотреть его заново, что бы это было?',
                        'Если бы ты был президентом на день, какой бы закон ты принял первым делом?',
                        'Если бы ты мог обменять 10 лет своей жизни на что-то, что бы это было?',
                        'Если бы твоя жизнь была фильмом, какого бы он был жанра и кто бы сыграл тебя?',
                    ],
                },
                {
                    category: 'О себе и личности',
                    questions: [
                        'Какой твой самый большой страх?',
                        'О чем ты чаще всего врешь?',
                        'Какая твоя самая нелюбимая черта характера?',
                        'Что в себе ты больше всего ценишь?',
                        'Какой самый смелый поступок в твоей жизни?',
                        "Что для тебя значит 'быть собой'?",
                        'Какой период твоей жизни был самым счастливым?',
                        'Что тебя бесит в других людях?',
                        'Как ты представляешь себя через 10 лет?',
                        'Что для тебя важнее: быть правым или сохранить отношения?',
                    ],
                },
                {
                    category: 'Случайные/Забавные',
                    questions: [
                        'Какая самая странная вещь, которая тебя возбуждает?',
                        'О чем ты думаешь, когда сидишь в туалете?',
                        'Какой самый странный способ знакомства с людьми ты использовал?',
                        'Если бы твоя жизнь была песней, какая бы это была песня?',
                        'Какой самый бесполезный навык у тебя есть?',
                        'Что самое странное ты делал в постели?',
                        'Какую самую безумную вещь ты сделал из-за спора?',
                        'Если бы ты был блюдом, каким бы ты был?',
                        'Какая самая странная вещь, которую ты коллекционировал?',
                        'Какой самый неловкий момент был у тебя с родителями?',
                    ],
                },
                {
                    category: 'Глубокие размышления',
                    questions: [
                        'Существует ли справедливость в мире?',
                        'Все ли средства хороши для достижения цели?',
                        'Можно ли купить счастье за деньги?',
                        'Веришь ли ты в судьбу?',
                        'Что такое настоящая дружба?',
                        'Можно ли изменить человека?',
                        'Что важнее: говорить правду или быть тактичным?',
                        'Существует ли абсолютное добро и зло?',
                        'Можно ли прочить все?',
                        'Что такое успех по-твоему?',
                    ],
                },
                {
                    category: 'Для веселой компании',
                    questions: [
                        'Какая самая странная фантазия у тебя была?',
                        'Какой самый неудачный секс в твоей жизни?',
                        'Когда ты в последний раз пукал в общественном месте?',
                        'Какая самая странная часть твоего тела?',
                        'Что самое пошлое, что ты делал?',
                        'Какой самый дебильный поступок ты совершил в школе?',
                        'Когда ты в последний раз писал в штаны (будучи взрослым)?',
                        'Какую самую странную вещь ты находил в своей постели?',
                        'Какое самое странное место, где ты занимался сексом?',
                        'Какую самую глупую вещь ты украл?',
                    ],
                },
                {
                    category: 'Для саморефлексии',
                    questions: [
                        'Какая твоя самая большая слабость?',
                        'Чего ты боишься больше всего в будущем?',
                        'Что ты хотел бы изменить в своем прошлом?',
                        'Какой самый важный выбор ты сделал в жизни?',
                        "Что для тебя значит 'жить полной жизнью'?",
                        'Чему ты научился у своих самых больших ошибок?',
                        'Что для тебя важнее: быть любимым или любить?',
                        "Как ты понимаешь слово 'успех'?",
                        "Что для тебя значит 'быть счастливым'?",
                        "Если бы ты мог дать совет своему 16-летнему 'я', что бы это был за совет?",
                    ],
                },
            ];

            // Переменные состояния
            let currentUser = null;
            let userQuestions = [];
            let currentQuestionIndex = 0;
            let currentQuestions = [];
            let isAllQuestionsMode = false;
            let answeredQuestions = new Set();
            let timerInterval;
            let startTime = null;
            let elapsedTime = 0;
            let totalTime = 10 * 60;

            // Элементы DOM
            const timerWrapper = document.getElementById('timerWrapper');
            const passwordScreen = document.getElementById('passwordScreen');
            const welcomeScreen = document.getElementById('welcomeScreen');
            const startScreen = document.getElementById('startScreen');
            const questionsScreen = document.getElementById('questionsScreen');
            const finishScreen = document.getElementById('finishScreen');
            const finalScreen = document.getElementById('finalScreen');
            const questionsListModal = document.getElementById('questionsListModal');
            const passwordInput = document.getElementById('passwordInput');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const passwordError = document.getElementById('passwordError');
            const welcomeTitle = document.getElementById('welcomeTitle');
            const startQuizBtn = document.getElementById('startQuizBtn');
            const resetProgressBtn = document.getElementById('resetProgressBtn');
            const startBtn = document.getElementById('startBtn');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const listBtn = document.getElementById('listBtn');
            const finishListBtn = document.getElementById('finishListBtn');
            const finalListBtn = document.getElementById('finalListBtn');
            const closeListBtn = document.getElementById('closeListBtn');
            const restartBtn = document.getElementById('restartBtn');
            const finalRestartBtn = document.getElementById('finalRestartBtn');
            const moreQuestionsBtn = document.getElementById('moreQuestionsBtn');
            const questionText = document.getElementById('questionText');
            const questionCategory = document.getElementById('questionCategory');
            const counter = document.getElementById('counterText');
            const timerDisplay = document.getElementById('timerDisplay');
            const timerElement = document.getElementById('timer');
            const stars = document.getElementById('stars');
            const questionsList = document.getElementById('questionsList');

            // Модальные окна
            const confirmationModal1 = document.getElementById('confirmationModal1');
            const confirmationModal2 = document.getElementById('confirmationModal2');
            const timeoutModal = document.getElementById('timeoutModal');

            // Кнопки подтверждения
            const confirmYes1 = document.getElementById('confirmYes1');
            const confirmNo1 = document.getElementById('confirmNo1');
            const confirmYes2 = document.getElementById('confirmYes2');
            const confirmNo2 = document.getElementById('confirmNo2');
            const timeoutOkBtn = document.getElementById('timeoutOkBtn');

            // Функция для сохранения текущего пользователя
            function saveCurrentUser(user) {
                localStorage.setItem(
                    'currentQuizUser',
                    JSON.stringify({
                        name: user.name,
                        timestamp: Date.now(),
                    })
                );
            }

            // Функция для загрузки текущего пользователя
            function loadCurrentUser() {
                const savedUser = localStorage.getItem('currentQuizUser');
                if (savedUser) {
                    const userData = JSON.parse(savedUser);
                    const oneWeek = 7 * 24 * 60 * 60 * 1000;

                    if (Date.now() - userData.timestamp < oneWeek) {
                        return userData.name;
                    } else {
                        localStorage.removeItem('currentQuizUser');
                    }
                }
                return null;
            }

            // Функция для удаления текущего пользователя
            function clearCurrentUser() {
                localStorage.removeItem('currentQuizUser');
                localStorage.removeItem(`quizState_${currentUser}`);
                currentUser = null;
            }

            // Функция для проверки авторизации при загрузке страницы
            function checkAuthOnLoad() {
                const savedUserName = loadCurrentUser();
                if (savedUserName) {
                    // Находим пользователя по имени
                    for (const [password, userConfig] of Object.entries(USER_CONFIG)) {
                        if (userConfig.name === savedUserName) {
                            currentUser = savedUserName;
                            userQuestions = userConfig.mainQuestions;
                            currentQuestions = userQuestions;

                            welcomeTitle.textContent = `С возвращением, ${currentUser}!`;
                            showScreen(welcomeScreen);
                            logoutBtn.style.display = 'inline-block';
                            return true;
                        }
                    }
                }
                // Если пользователь не найден, показываем экран входа
                showScreen(passwordScreen);
                return false;
            }

            // Функция для показа экрана
            function showScreen(screen) {
                document.querySelectorAll('.screen').forEach((s) => s.classList.remove('active'));
                screen.classList.add('active');
            }

            // Функция для загрузки состояния викторины
            function loadQuizState() {
                const savedState = localStorage.getItem(`quizState_${currentUser}`);
                if (savedState) {
                    const state = JSON.parse(savedState);
                    const twoHours = 2 * 60 * 60 * 1000;

                    if (Date.now() - state.timestamp < twoHours) {
                        currentQuestionIndex = state.currentQuestionIndex || 0;
                        isAllQuestionsMode = state.isAllQuestionsMode || false;
                        answeredQuestions = new Set(state.answeredQuestions || []);
                        elapsedTime = state.elapsedTime || 0;
                        totalTime = state.totalTime || 10 * 60;

                        if (state.startTime) {
                            startTime = new Date(state.startTime);
                            const now = new Date();
                            const timePassed = Math.floor(
                                (now.getTime() - startTime.getTime()) / 1000
                            );
                            elapsedTime = state.elapsedTime + timePassed;

                            if (elapsedTime >= totalTime) {
                                elapsedTime = totalTime;
                            }
                        }

                        if (state.currentQuestions === 'all') {
                            currentQuestions = getAllQuestionsFlattened();
                            isAllQuestionsMode = true;
                        } else {
                            currentQuestions = userQuestions;
                            isAllQuestionsMode = false;
                        }

                        const allQuestionsCount = getAllQuestionsFlattened().length;

                        if (isAllQuestionsMode && answeredQuestions.size >= allQuestionsCount) {
                            showScreen(finalScreen);
                            updateQuestionCategory();
                        } else if (
                            !isAllQuestionsMode &&
                            answeredQuestions.size >= userQuestions.length
                        ) {
                            showScreen(finishScreen);
                            updateQuestionCategory();
                        } else if (currentQuestionIndex >= currentQuestions.length) {
                            if (isAllQuestionsMode) {
                                showScreen(finalScreen);
                            } else {
                                showScreen(finishScreen);
                            }
                            updateQuestionCategory();
                        } else {
                            showScreen(questionsScreen);
                            updateQuestion();
                            updateTimerDisplay();
                            if (startTime && elapsedTime < totalTime) {
                                startTimer();
                            } else if (elapsedTime >= totalTime) {
                                timerElement.classList.add('expired');
                            }
                            updateQuestionCategory();
                        }
                        return true;
                    } else {
                        localStorage.removeItem(`quizState_${currentUser}`);
                    }
                }
                return false;
            }

            // Функция для получения всех вопросов в одном массиве
            function getAllQuestionsFlattened() {
                const flattened = [];
                allQuestions.forEach((category) => {
                    category.questions.forEach((question) => {
                        flattened.push(question);
                    });
                });
                return flattened;
            }

            // Функция для получения текущей категории вопроса
            function getCurrentCategory() {
                if (!isAllQuestionsMode) return `${currentUser}`;

                let questionCount = 0;
                for (let i = 0; i < allQuestions.length; i++) {
                    questionCount += allQuestions[i].questions.length;
                    if (currentQuestionIndex < questionCount) {
                        return allQuestions[i].category;
                    }
                }
                return `${currentUser}`;
            }

            // Функция для обновления заголовка категории
            function updateQuestionCategory() {
                questionCategory.textContent = getCurrentCategory();

                // Скрыть таймер для 100 вопросов
                if (isAllQuestionsMode) {
                    timerWrapper.classList.add('hidden');
                } else {
                    timerWrapper.classList.remove('hidden');
                }
            }
            // Функция для показа/скрытия модального окна
            function toggleQuestionsList() {
                questionsListModal.classList.toggle('active');
                finishScreen.classList.remove('active');
                finalScreen.classList.remove('active');
                if (questionsListModal.classList.contains('active')) {
                    renderQuestionsList();
                }
            }

            // Функция для рендеринга списка вопросов
            function renderQuestionsList() {
                questionsList.innerHTML = '';

                const mainQuestionsTitle = document.createElement('div');
                mainQuestionsTitle.className = 'stage-title';
                mainQuestionsTitle.textContent = `Основные вопросы для ${currentUser} (10)`;
                questionsList.appendChild(mainQuestionsTitle);

                userQuestions.forEach((question, index) => {
                    const questionItem = document.createElement('div');
                    questionItem.className = `question-item ${
                        answeredQuestions.has(index) ? 'answered' : 'unanswered'
                    } ${index === currentQuestionIndex && !isAllQuestionsMode ? 'current' : ''}`;
                    questionItem.dataset.index = index;

                    questionItem.innerHTML = `
                        <div class="question-number">${index + 1}</div>
                        <div class="question-text-short">${
                            question.length > 50 ? question.substring(0, 50) + '...' : question
                        }</div>
                        <div class="question-status">
                            <i class="fas ${
                                answeredQuestions.has(index) ? 'fa-check-circle' : 'fa-circle'
                            }"></i>
                        </div>
                    `;

                    questionItem.addEventListener('click', () => {
                        if (!isAllQuestionsMode) {
                            currentQuestionIndex = parseInt(questionItem.dataset.index);
                            updateQuestion();
                            toggleQuestionsList();
                        }
                    });

                    questionsList.appendChild(questionItem);
                });

                if (answeredQuestions.size >= userQuestions.length) {
                    const allQuestionsTitle = document.createElement('div');
                    allQuestionsTitle.className = 'stage-title';
                    allQuestionsTitle.textContent = 'Дополнительные вопросы (100)';
                    questionsList.appendChild(allQuestionsTitle);

                    const allQuestionsFlattened = getAllQuestionsFlattened();
                    allQuestionsFlattened.forEach((question, index) => {
                        const adjustedIndex = index + userQuestions.length;
                        const questionItem = document.createElement('div');
                        questionItem.className = `question-item ${
                            answeredQuestions.has(adjustedIndex) ? 'answered' : 'unanswered'
                        } ${
                            index === currentQuestionIndex - userQuestions.length &&
                            isAllQuestionsMode
                                ? 'current'
                                : ''
                        }`;
                        questionItem.dataset.index = index;

                        questionItem.innerHTML = `
                            <div class="question-number">${index + 1}</div>
                            <div class="question-text-short">${
                                question.length > 50 ? question.substring(0, 50) + '...' : question
                            }</div>
                            <div class="question-status">
                                <i class="fas ${
                                    answeredQuestions.has(adjustedIndex)
                                        ? 'fa-check-circle'
                                        : 'fa-circle'
                                }"></i>
                            </div>
                        `;

                        questionItem.addEventListener('click', () => {
                            currentQuestions = allQuestionsFlattened;
                            isAllQuestionsMode = true;
                            currentQuestionIndex = index;
                            updateQuestion();
                            toggleQuestionsList();
                        });

                        questionsList.appendChild(questionItem);
                    });
                }
            }

            // Функция обновления вопроса
            function updateQuestion() {
                if (currentQuestionIndex < currentQuestions.length) {
                    questionText.textContent = currentQuestions[currentQuestionIndex];
                    updateQuestionCategory();
                    counter.textContent = `${currentQuestionIndex + 1}/${currentQuestions.length}`;
                    showScreen(questionsScreen);
                    const questionId = isAllQuestionsMode
                        ? currentQuestionIndex + userQuestions.length
                        : currentQuestionIndex;
                    answeredQuestions.add(questionId);
                }

                prevBtn.disabled = currentQuestionIndex === 0;

                if (currentQuestionIndex === currentQuestions.length - 1) {
                    nextBtn.innerHTML = '<i class="fas fa-check"></i>';
                    nextBtn.classList.add('submit-btn');
                } else {
                    nextBtn.innerHTML = '<i class="fas fa-arrow-right"></i>';
                    nextBtn.classList.remove('submit-btn');
                }

                saveQuizState();
            }

            // Функция сохранения состояния викторины
            function saveQuizState() {
                const state = {
                    currentQuestionIndex,
                    currentQuestions: isAllQuestionsMode ? 'all' : 'user',
                    isAllQuestionsMode,
                    answeredQuestions: Array.from(answeredQuestions),
                    startTime: startTime ? startTime.getTime() : null,
                    elapsedTime,
                    totalTime,
                    timestamp: Date.now(),
                };
                localStorage.setItem(`quizState_${currentUser}`, JSON.stringify(state));
            }

            // Функция обновления отображения таймера
            function updateTimerDisplay() {
                const timeLeft = totalTime - elapsedTime;
                if (timeLeft <= 0) {
                    timerDisplay.textContent = '00:00';
                    timerElement.classList.add('expired');
                    return;
                }

                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds
                    .toString()
                    .padStart(2, '0')}`;
            }

            // Функция для запуска таймера
            function startTimer() {
                clearInterval(timerInterval);

                if (!startTime) {
                    startTime = new Date();
                    elapsedTime = 0;
                }

                timerInterval = setInterval(() => {
                    const now = new Date();
                    elapsedTime = Math.floor((now.getTime() - startTime.getTime()) / 1000);

                    if (elapsedTime >= totalTime) {
                        clearInterval(timerInterval);
                        elapsedTime = totalTime;
                        timerElement.classList.add('expired');
                        showModal(timeoutModal);
                    }

                    updateTimerDisplay();
                    saveQuizState();
                }, 1000);
            }

            // Функция сброса состояния викторины
            function resetQuizState() {
                currentQuestionIndex = 0;
                currentQuestions = userQuestions;
                isAllQuestionsMode = false;
                answeredQuestions.clear();
                startTime = null;
                elapsedTime = 0;
                totalTime = 10 * 60;
                timerElement.classList.remove('expired');
                updateTimerDisplay();
                updateQuestion();
                clearInterval(timerInterval);
                localStorage.removeItem(`quizState_${currentUser}`);
            }

            // Функция для полного сброса прогресса
            function resetAllProgress() {
                if (
                    confirm(
                        'Вы уверены, что хотите сбросить весь прогресс? Это действие нельзя отменить.'
                    )
                ) {
                    clearCurrentUser();
                    currentUser = null;
                    showScreen(passwordScreen);
                }
            }

            // Функция для показа модального окна
            function showModal(modal) {
                modal.classList.add('active');
            }

            // Функция для скрытия модального окна
            function hideModal(modal) {
                modal.classList.remove('active');
            }

            // Обработчик входа
            loginBtn.addEventListener('click', () => {
                const password = passwordInput.value;

                if (USER_CONFIG[password]) {
                    currentUser = USER_CONFIG[password].name;
                    userQuestions = USER_CONFIG[password].mainQuestions;
                    currentQuestions = userQuestions;

                    // Сохраняем пользователя
                    saveCurrentUser(USER_CONFIG[password]);

                    // Очищаем поле и скрываем ошибку
                    passwordInput.value = '';
                    passwordError.style.display = 'none';

                    // Показываем приветствие
                    welcomeTitle.textContent = `Привет, ${currentUser}!`;
                    showScreen(welcomeScreen);
                    logoutBtn.style.display = 'inline-block';
                } else {
                    passwordError.style.display = 'block';
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            });

            // Обработчик выхода
            logoutBtn.addEventListener('click', () => {
                clearCurrentUser();
                currentUser = null;
                showScreen(passwordScreen);
                logoutBtn.style.display = 'none';
            });

            // Ввод пароля по нажатию Enter
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loginBtn.click();
                }
            });

            // Обработчики событий
            startQuizBtn.addEventListener('click', () => {
                if (!loadQuizState()) {
                    showScreen(startScreen);
                }
            });

            // Кнопка сброса прогресса
            resetProgressBtn.addEventListener('click', resetAllProgress);

            startBtn.addEventListener('click', () => {
                showModal(confirmationModal1);
            });

            confirmYes1.addEventListener('click', () => {
                hideModal(confirmationModal1);
                showModal(confirmationModal2);
            });

            confirmNo1.addEventListener('click', () => {
                hideModal(confirmationModal1);
            });

            confirmYes2.addEventListener('click', () => {
                hideModal(confirmationModal2);
                showScreen(questionsScreen);
                updateQuestion();
                startTimer();
            });

            confirmNo2.addEventListener('click', () => {
                hideModal(confirmationModal2);
            });

            // Навигация по вопросам
            prevBtn.addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    updateQuestion();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    updateQuestion();
                } else {
                    clearInterval(timerInterval);

                    if (isAllQuestionsMode) {
                        showScreen(finalScreen);
                    } else {
                        showScreen(finishScreen);
                    }

                    localStorage.removeItem(`quizState_${currentUser}`);
                }
            });

            // Кнопки списка вопросов
            listBtn.addEventListener('click', toggleQuestionsList);
            finishListBtn.addEventListener('click', toggleQuestionsList);
            finalListBtn.addEventListener('click', toggleQuestionsList);
            closeListBtn.addEventListener('click', toggleQuestionsList);

            // Кнопка "Больше вопросов"
            moreQuestionsBtn.addEventListener('click', () => {
                currentQuestions = getAllQuestionsFlattened();
                currentQuestionIndex = 0;
                isAllQuestionsMode = true;
                elapsedTime = 0;
                totalTime = 10 * 60;
                startTime = new Date();
                timerElement.classList.remove('expired');

                timerWrapper.classList.add('hidden');

                showScreen(questionsScreen);
                updateQuestion();
                startTimer();
            });

            // Перезапуск викторины
            restartBtn.addEventListener('click', () => {
                resetQuizState();
                showScreen(startScreen);
            });

            finalRestartBtn.addEventListener('click', () => {
                resetQuizState();
                showScreen(startScreen);
            });

            // Обработка завершения по таймауту
            timeoutOkBtn.addEventListener('click', () => {
                hideModal(timeoutModal);
                if (isAllQuestionsMode) {
                    showScreen(finalScreen);
                } else {
                    showScreen(finishScreen);
                }
                localStorage.removeItem(`quizState_${currentUser}`);
            });

            // Инициализация при загрузке страницы
            window.addEventListener('DOMContentLoaded', () => {
                if (!checkAuthOnLoad()) {
                    passwordInput.focus();
                }
            });
        </script>
    </body>
</html>
